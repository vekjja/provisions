image:
  tag: "3.3.0"

deploymentMode: SingleBinary

# ---- SingleBinary ON
singleBinary:
  replicas: 1
  resources:
    limits:
      cpu: 2000m
      memory: 2Gi
    requests:
      cpu: 500m
      memory: 1Gi

# ---- Force scalable targets OFF
read:
  replicas: 0
write:
  replicas: 0
backend:
  replicas: 0

loki:
  auth_enabled: false

  commonConfig:
    replication_factor: 1

  # Chart-level storage selector (filesystem)
  storage:
    type: filesystem
    filesystem:
      chunks_directory: /var/loki/chunks
      rules_directory: /var/loki/rules

  schemaConfig:
    configs:
    - from: "2024-01-01"
      store: tsdb
      object_store: filesystem
      schema: v13
      index:
        prefix: index_
        period: 24h

  limits_config:
    retention_period: 192h
    volume_enabled: true
    discover_service_name:
    - service_name
    - service
    - app
    - application
    - name
    - app_kubernetes_io_name
    - pod
    - container
    - container_name
    - component
    - workload
    - job

  # Ruler disabled at both Loki config + chart level below
  ruler:
    enable_api: false

chunksCache:
  enabled: false

resultsCache:
  enabled: false

gateway:
  enabled: false

ruler:
  enabled: false

persistence:
  enabled: true
  storageClassName: local-path
  accessModes:
  - ReadWriteOnce
  size: 20Gi
