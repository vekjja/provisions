# Default values for kube-prometheus-stack
# https://github.com/prometheus-community/helm-charts/tree/main/charts/kube-prometheus-stack

# Enable Grafana (included in kube-prometheus-stack, pre-configured with Prometheus)
grafana:
  enabled: true

  # Admin credentials
  admin:
    existingSecret: grafana-admin-credentials
    userKey: admin-user
    passwordKey: admin-password

  # Persistence
  persistence:
    enabled: true
    storageClassName: "local-path"
    size: 10Gi

  # Ingress
  ingress:
    enabled: true
    ingressClassName: nginx
    annotations:
      cert-manager.io/cluster-issuer: cloudflare-letsencrypt-production
    hosts:
    - graf.livingroom.cloud
    path: /
    pathType: Prefix
    tls:
    - secretName: graf.livingroom.cloud-tls
      hosts:
      - graf.livingroom.cloud

  # Resources
  resources:
    limits:
      cpu: 1000m
      memory: 1024Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # Service
  service:
    type: ClusterIP
    port: 80

  # Dashboard configuration
  # Enable/disable default dashboards that come with kube-prometheus-stack
  defaultDashboardsEnabled:
    # Core Kubernetes dashboards
    k8sCluster: true
    k8sNode: true
    k8sPod: true
    k8sResource: true
    k8sApiserver: true
    k8sKubelet: true
    k8sProxy: true
    k8sScheduler: true
    k8sControllerManager: true
    k8sEtcd: true
    # Node exporter dashboards
    nodeExporter: true
    nodeExporterNodes: true
    # Prometheus dashboards
    prometheus: true
    prometheusOperator: true
    # Kube-state-metrics dashboards
    kubeStateMetrics: true
    # Grafana dashboards
    grafana: false

  # Sidecar for auto-discovering dashboards from ConfigMaps
  # Any ConfigMap with label "grafana_dashboard: 1" will be automatically loaded
  sidecar:
    dashboards:
      enabled: true
      label: grafana_dashboard
      labelValue: "1"
      # Search in all namespaces or specific namespace
      searchNamespace: ALL

# Prometheus configuration
prometheus:
  prometheusSpec:
    # Scrape interval - how often to collect metrics (default is 30s)
    scrapeInterval: 15s
    scrapeTimeout: 10s

    # Evaluation interval - how often to evaluate rules (default is 30s)
    evaluationInterval: 15s

    # Storage configuration
    storageSpec:
      volumeClaimTemplate:
        spec:
          storageClassName: "local-path"
          accessModes: [ "ReadWriteOnce" ]
          resources:
            requests:
              storage: 50Gi

    # Resource limits
    resources:
      limits:
        cpu: 2000m
        memory: 4Gi
      requests:
        cpu: 500m
        memory: 2Gi

    # Service configuration
    service:
      type: ClusterIP
      port: 9090

  # Prometheus ingress (disabled - access via port-forward if needed)
  ingress:
    enabled: false

# Alertmanager configuration (disabled for now)
alertmanager:
  enabled: false

# Node Exporter (collects node metrics)
nodeExporter:
  enabled: true

# Kube State Metrics (collects Kubernetes resource metrics)
kubeStateMetrics:
  enabled: true

# Prometheus Operator
prometheusOperator:
  enabled: true
  resources:
    limits:
      cpu: 200m
      memory: 200Mi
    requests:
      cpu: 100m
      memory: 100Mi
